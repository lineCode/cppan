<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Tutorial</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.77.1">
<link rel="home" href="../index.html" title="Chapter&#160;1.&#160;cppan 1.0">
<link rel="up" href="../index.html" title="Chapter&#160;1.&#160;cppan 1.0">
<link rel="prev" href="../index.html" title="Chapter&#160;1.&#160;cppan 1.0">
<link rel="next" href="../reference.html" title="Reference">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="spirit-nav">
<a accesskey="p" href="../index.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="../reference.html"><img src="../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="cppan.tutorial"></a><a class="link" href="tutorial.html" title="Tutorial">Tutorial</a>
</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="tutorial.html#cppan.tutorial.declaring_type_with_annotated_me">Declaring
      type with annotated members</a></span></dt>
<dt><span class="section"><a href="tutorial.html#cppan.tutorial.direct_access_to_members_and_ann">Direct
      access to members and annotations</a></span></dt>
<dt><span class="section"><a href="tutorial.html#cppan.tutorial.define_member_tester_metafunctio">Define
      member tester metafunction</a></span></dt>
<dt><span class="section"><a href="tutorial.html#cppan.tutorial.introspect_members_and_annotatio">Introspect
      members and annotations</a></span></dt>
<dt><span class="section"><a href="tutorial.html#cppan.tutorial.simple_io_with_std_streams">Simple IO
      with std streams</a></span></dt>
<dt><span class="section"><a href="tutorial.html#cppan.tutorial.making_class_hierarchies">Making class
      hierarchies</a></span></dt>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="cppan.tutorial.declaring_type_with_annotated_me"></a><a class="link" href="tutorial.html#cppan.tutorial.declaring_type_with_annotated_me" title="Declaring type with annotated members">Declaring
      type with annotated members</a>
</h3></div></div></div>
<p>
        Here is how you can declare class members with annotations
      </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cppan</span><span class="special">/</span><span class="identifier">declare_and_annotate</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">struct</span> <span class="identifier">A</span>
<span class="special">{</span>
    <span class="identifier">CPPAN_DECLARE_AND_ANNOTATE</span><span class="special">(</span>
        <span class="special">((</span><span class="keyword">int</span><span class="special">,</span> <span class="identifier">int_field_</span><span class="special">,</span>
            <span class="special">((</span><span class="identifier">int_annotation</span><span class="special">,</span> <span class="number">42</span><span class="special">))</span>
            <span class="special">((</span><span class="identifier">string_annotation</span><span class="special">,</span> <span class="string">"Hello world"</span><span class="special">))</span>
        <span class="special">))</span>
        <span class="special">((</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">,</span> <span class="identifier">string_field_</span><span class="special">,</span>
            <span class="special">((</span><span class="identifier">no_serialization</span><span class="special">,</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">true_type</span><span class="special">()))</span>
            <span class="special">((</span><span class="identifier">no_hash</span><span class="special">,</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">true_type</span><span class="special">()))</span>
        <span class="special">))</span>
        <span class="special">((</span><span class="keyword">double</span><span class="special">,</span> <span class="identifier">no_ann_field_</span><span class="special">,</span> <span class="identifier">CPPAN_NIL_SEQ</span><span class="special">))</span>
    <span class="special">)</span>
<span class="special">};</span>
</pre>
<p>
        <code class="computeroutput"><a class="link" href="../CPPAN_DECLARE_AND_ANNOTATE.html" title="Macro CPPAN_DECLARE_AND_ANNOTATE">CPPAN_DECLARE_AND_ANNOTATE</a></code>
        utilize <a href="http://www.boost.org/doc/libs/1_52_0/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
        sequences to declare members, and sequence of annotations associated with
        each member. The code above effectively expands into following
      </p>
<pre class="programlisting"><span class="keyword">struct</span> <span class="identifier">A</span>
<span class="special">{</span>
    <span class="comment">// --------------------------------------------------------------------------------------------------</span>
    <span class="comment">// This typedef is a marker that type has used CPPAN_DECLARE_AND_ANNOTATE to declare it`s members. </span>
    <span class="comment">// Use cppan::has_annotations metafunction to determine presence of this typedef in compile time.</span>
    <span class="comment">// --------------------------------------------------------------------------------------------------</span>

    <span class="keyword">typedef</span> <span class="keyword">void</span> <span class="identifier">annotated_tag</span><span class="special">;</span>

    <span class="comment">// --------------------------------------------------------------------------------------------------</span>
    <span class="comment">// Members</span>
    <span class="comment">// --------------------------------------------------------------------------------------------------</span>

    <span class="keyword">int</span> <span class="identifier">int_field_</span><span class="special">;</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="identifier">string_field_</span><span class="special">;</span>
    <span class="keyword">double</span> <span class="identifier">no_ann_field_</span><span class="special">;</span>

    <span class="comment">// --------------------------------------------------------------------------------------------------</span>
    <span class="comment">// Each member has associated nested structure with annotations</span>
    <span class="comment">// --------------------------------------------------------------------------------------------------</span>

    <span class="keyword">struct</span> <span class="identifier">annotations_for_int_field_</span>
    <span class="special">{</span>
        <span class="comment">// During construction members get annotation values</span>
        <span class="identifier">annotations_for_int_field_</span> <span class="special">()</span>
            <span class="special">:</span>  <span class="identifier">int_annotation</span><span class="special">(</span><span class="number">42</span><span class="special">)</span>
            <span class="special">,</span> <span class="identifier">string_annotation</span><span class="special">(</span><span class="string">"Hello world"</span><span class="special">)</span>
        <span class="special">{}</span>

        <span class="identifier">decltype</span><span class="special">(</span><span class="number">42</span><span class="special">)</span> <span class="identifier">int_annotation</span><span class="special">;</span>
        <span class="identifier">decltype</span><span class="special">(</span><span class="string">"Hello world"</span><span class="special">)</span> <span class="identifier">string_annotation</span><span class="special">;</span>
    <span class="special">};</span>

    <span class="keyword">struct</span> <span class="identifier">annotations_for_string_field_</span>
    <span class="special">{</span>
        <span class="identifier">annotations_for_string_field_</span> <span class="special">()</span>
            <span class="special">:</span>  <span class="identifier">no_serialization</span><span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">true_type</span><span class="special">())</span>
            <span class="special">,</span> <span class="identifier">no_hash</span><span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">true_type</span><span class="special">())</span>
        <span class="special">{}</span>

        <span class="comment">// Developer can use types that incorporate annotation values, in that case annotation values can</span>
        <span class="comment">// be accessed during compile time.</span>
        <span class="identifier">decltype</span><span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">true_type</span><span class="special">())</span> <span class="identifier">no_serialization</span><span class="special">;</span>
        <span class="identifier">decltype</span><span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">true_type</span><span class="special">())</span> <span class="identifier">no_hash</span><span class="special">;</span>
    <span class="special">};</span>

    <span class="comment">// Annotations type is created for member without annotations, however it doesn`t incorporate any annotations</span>
    <span class="keyword">struct</span> <span class="identifier">annotations_for_no_ann_field_</span>
    <span class="special">{</span>
        <span class="identifier">annotations_for_no_ann_field_</span> <span class="special">()</span>   <span class="special">{}</span>
    <span class="special">};</span>

    <span class="comment">// ----------------------------------------------------------------------------------------------------------</span>
    <span class="comment">// Following metafunction allow other parts of cppan to introspect members and annotations as fusion sequence</span>
    <span class="comment">// ----------------------------------------------------------------------------------------------------------</span>

    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">struct</span> <span class="identifier">apply</span>
    <span class="special">{</span>
        <span class="keyword">typedef</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">mpl</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span>
            <span class="special">::</span><span class="identifier">cppan</span><span class="special">::</span><span class="identifier">detail</span><span class="special">::</span><span class="identifier">member_shortcut</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">,</span> <span class="keyword">int</span><span class="special">,</span> <span class="special">&amp;</span><span class="identifier">T</span><span class="special">::</span><span class="identifier">int_field_</span><span class="special">,</span> <span class="identifier">annotations_for_int_field_</span><span class="special">&gt;</span>
          <span class="special">,</span> <span class="special">::</span><span class="identifier">cppan</span><span class="special">::</span><span class="identifier">detail</span><span class="special">::</span><span class="identifier">member_shortcut</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">,</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">,</span> <span class="special">&amp;</span><span class="identifier">T</span><span class="special">::</span><span class="identifier">string_field_</span><span class="special">,</span> <span class="identifier">annotations_for_string_field_</span><span class="special">&gt;</span>
          <span class="special">,</span> <span class="special">::</span><span class="identifier">cppan</span><span class="special">::</span><span class="identifier">detail</span><span class="special">::</span><span class="identifier">member_shortcut</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">,</span> <span class="keyword">double</span><span class="special">,</span> <span class="special">&amp;</span><span class="identifier">T</span><span class="special">::</span><span class="identifier">no_ann_field_</span><span class="special">,</span> <span class="identifier">annotations_for_no_ann_field_</span><span class="special">&gt;</span>
          <span class="special">&gt;</span> <span class="identifier">self_shortcuts</span><span class="special">;</span>

        <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="special">::</span><span class="identifier">cppan</span><span class="special">::</span><span class="identifier">detail</span><span class="special">::</span><span class="identifier">join_all_shortcuts</span><span class="special">&lt;</span><span class="identifier">base_types</span><span class="special">,</span> <span class="identifier">self_shortcuts</span><span class="special">&gt;::</span><span class="identifier">type</span> <span class="identifier">type</span><span class="special">;</span>
    <span class="special">};</span>
<span class="special">};</span>
</pre>
<p>
        As you can see, <code class="computeroutput"><span class="identifier">apply</span></code> metafunction
        plays key role here. It allows other parts of library introspect members
        and annotations. Using <code class="computeroutput"><a class="link" href="has_annotations.html" title="Struct template has_annotations">cppan::has_annotations</a></code>
        metafunction, we can test if class member was declared with annotations.
      </p>
<pre class="programlisting"><span class="identifier">BOOST_MPL_ASSERT</span><span class="special">((</span><span class="identifier">has_annotations</span><span class="special">&lt;</span><span class="identifier">A</span><span class="special">&gt;));</span>
<span class="identifier">BOOST_MPL_ASSERT_NOT</span><span class="special">((</span><span class="identifier">has_annotations</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;));</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="cppan.tutorial.direct_access_to_members_and_ann"></a><a class="link" href="tutorial.html#cppan.tutorial.direct_access_to_members_and_ann" title="Direct access to members and annotations">Direct
      access to members and annotations</a>
</h3></div></div></div>
<p>
        After we have declared our structure we want access it's members and annotation
        types:
      </p>
<pre class="programlisting"><span class="identifier">A</span> <span class="identifier">a</span><span class="special">;</span>

<span class="identifier">a</span><span class="special">.</span><span class="identifier">int_field_</span> <span class="special">=</span> <span class="number">100</span><span class="special">;</span>
<span class="identifier">a</span><span class="special">.</span><span class="identifier">string_field_</span> <span class="special">=</span> <span class="string">"string field"</span><span class="special">;</span>
<span class="identifier">a</span><span class="special">.</span><span class="identifier">no_ann_field_</span> <span class="special">=</span> <span class="number">20.</span><span class="special">;</span>

<span class="identifier">A</span><span class="special">::</span><span class="identifier">annotations_for_int_field_</span> <span class="identifier">a1</span><span class="special">;</span>
<span class="identifier">A</span><span class="special">::</span><span class="identifier">annotations_for_string_field_</span> <span class="identifier">a2</span><span class="special">;</span>
<span class="identifier">A</span><span class="special">::</span><span class="identifier">annotations_for_no_ann_field_</span> <span class="identifier">a3</span><span class="special">;</span>

<span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"Value of int_annotation for A::int_field_"</span> <span class="special">&lt;&lt;</span> <span class="identifier">a1</span><span class="special">.</span><span class="identifier">int_annotation</span> <span class="special">&lt;&lt;</span> <span class="identifier">endl</span><span class="special">;</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="cppan.tutorial.define_member_tester_metafunctio"></a><a class="link" href="tutorial.html#cppan.tutorial.define_member_tester_metafunctio" title="Define member tester metafunction">Define
      member tester metafunction</a>
</h3></div></div></div>
<p>
        To determine if A::annotations_for_string_field_ has no_hash annotation,
        we need to define metafunction that check presence of no_hash member with
        <code class="computeroutput"><a class="link" href="../CPPAN_DEFINE_MEMBER_DETECTOR.html" title="Macro CPPAN_DEFINE_MEMBER_DETECTOR">CPPAN_DEFINE_MEMBER_DETECTOR</a></code>.
      </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">mpl</span><span class="special">/</span><span class="identifier">assert</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="identifier">CPPAN_DEFINE_MEMBER_DETECTOR</span><span class="special">(</span><span class="identifier">no_hash</span><span class="special">);</span>

<span class="identifier">BOOST_MPL_ASSERT</span><span class="special">((</span><span class="identifier">has_no_hash</span><span class="special">&lt;</span><span class="identifier">A</span><span class="special">::</span><span class="identifier">annotations_for_string_field_</span><span class="special">&gt;));</span>
<span class="identifier">BOOST_MPL_ASSERT_NOT</span><span class="special">((</span><span class="identifier">has_no_hash</span><span class="special">&lt;</span><span class="identifier">A</span><span class="special">::</span><span class="identifier">annotations_for_int_field_</span><span class="special">&gt;));</span>
<span class="identifier">BOOST_MPL_ASSERT_NOT</span><span class="special">((</span><span class="identifier">has_no_hash</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;));</span>
</pre>
</div>
<p>
      has_no_hash also contains specialization for <code class="computeroutput"><a class="link" href="member.html" title="Struct template member">member</a></code>
      class. In that case it will step into annotations type to check presence of
      desired annotation.
    </p>
<pre class="programlisting"><span class="identifier">BOOST_MPL_ASSERT</span><span class="special">((</span><span class="identifier">has_no_hash</span><span class="special">&lt;</span><span class="identifier">cppan</span><span class="special">::</span><span class="identifier">member</span><span class="special">&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">,</span> <span class="identifier">A</span><span class="special">::</span><span class="identifier">annotations_for_string_field_</span><span class="special">&gt;</span> <span class="special">&gt;));</span>
<span class="identifier">BOOST_MPL_ASSERT_NOT</span><span class="special">((</span><span class="identifier">has_no_hash</span><span class="special">&lt;</span><span class="identifier">cppan</span><span class="special">::</span><span class="identifier">member</span><span class="special">&lt;</span> <span class="keyword">int</span><span class="special">,</span> <span class="identifier">A</span><span class="special">::</span><span class="identifier">annotations_for_int_field_</span><span class="special">&gt;</span> <span class="special">&gt;));</span>
</pre>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="cppan.tutorial.introspect_members_and_annotatio"></a><a class="link" href="tutorial.html#cppan.tutorial.introspect_members_and_annotatio" title="Introspect members and annotations">Introspect
      members and annotations</a>
</h3></div></div></div>
<p>
        Power of <a href="http://www.boost.org/doc/libs/1_52_0/libs/fusion/doc/html" target="_top">Boost.Fusion</a>
        can be applied to members and annotations since cppan automatically extends
        it for any type that use <code class="computeroutput"><a class="link" href="../CPPAN_DECLARE_AND_ANNOTATE.html" title="Macro CPPAN_DECLARE_AND_ANNOTATE">CPPAN_DECLARE_AND_ANNOTATE</a></code>.
      </p>
<pre class="programlisting"><span class="keyword">struct</span> <span class="identifier">dump_members</span>
<span class="special">{</span>
    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">MemberType</span><span class="special">,</span> <span class="keyword">typename</span> <span class="identifier">AnnotationsType</span><span class="special">&gt;</span>
    <span class="keyword">void</span> <span class="keyword">operator</span><span class="special">()(</span><span class="keyword">const</span> <span class="identifier">cppan</span><span class="special">::</span><span class="identifier">member</span><span class="special">&lt;</span><span class="identifier">MemberType</span><span class="special">,</span> <span class="identifier">AnnotationsType</span><span class="special">&gt;&amp;</span> <span class="identifier">member</span><span class="special">)</span> <span class="keyword">const</span>
    <span class="special">{</span>
        <span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"Member value: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">member</span><span class="special">.</span><span class="identifier">value_</span> <span class="special">&lt;&lt;</span> <span class="identifier">endl</span><span class="special">;</span>

        <span class="comment">// We can make compile time check here whether member has specific annotation</span>
        <span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"\tHas no_hash annotation: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">has_no_hash</span><span class="special">&lt;</span><span class="identifier">AnnotationsType</span><span class="special">&gt;::</span><span class="identifier">value</span> <span class="special">&lt;&lt;</span> <span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span>
<span class="special">};</span>

<span class="special">...</span>
<span class="identifier">boost</span><span class="special">::</span><span class="identifier">fusion</span><span class="special">::</span><span class="identifier">for_each</span><span class="special">(</span><span class="identifier">a</span><span class="special">,</span> <span class="identifier">dump_members</span><span class="special">());</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="cppan.tutorial.simple_io_with_std_streams"></a><a class="link" href="tutorial.html#cppan.tutorial.simple_io_with_std_streams" title="Simple IO with std streams">Simple IO
      with std streams</a>
</h3></div></div></div>
<p>
        Although <a href="http://www.boost.org/doc/libs/1_52_0/libs/fusion/doc/html" target="_top">Boost.Fusion</a>
        provide input/output operator overloads they can't automatically handle sequence
        types that were declared outside of <a href="http://www.boost.org/doc/libs/1_52_0/libs/fusion/doc/html" target="_top">Boost.Fusion</a>
        namespace. cppan provide it`s own header to handle know types.
      </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cppan</span><span class="special">/</span><span class="identifier">io</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="identifier">A</span> <span class="identifier">a</span><span class="special">;</span>
<span class="keyword">const</span> <span class="keyword">char</span><span class="special">*</span> <span class="identifier">src</span> <span class="special">=</span> <span class="string">"(40 Hello 30.3)"</span><span class="special">;</span>
<span class="identifier">istringstream</span> <span class="identifier">iss</span><span class="special">(</span><span class="identifier">src</span><span class="special">);</span>
<span class="identifier">iss</span> <span class="special">&gt;&gt;</span> <span class="identifier">a</span><span class="special">;</span>
<span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="identifier">a</span><span class="special">;</span>
</pre>
<p>
        will produce
      </p>
<pre class="programlisting"><span class="special">(</span><span class="number">40</span> <span class="identifier">Hello</span> <span class="number">30.3</span><span class="special">)</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="cppan.tutorial.making_class_hierarchies"></a><a class="link" href="tutorial.html#cppan.tutorial.making_class_hierarchies" title="Making class hierarchies">Making class
      hierarchies</a>
</h3></div></div></div>
<p>
        <code class="computeroutput"><a class="link" href="../CPPAN_DECLARE_AND_ANNOTATE_WITH_BASE.html" title="Macro CPPAN_DECLARE_AND_ANNOTATE_WITH_BASE">CPPAN_DECLARE_AND_ANNOTATE_WITH_BASE</a></code>
        can be used to take into account members and annotations declared in base
        types
      </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cppan</span><span class="special">/</span><span class="identifier">declare_and_annotate</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">struct</span> <span class="identifier">B1</span>
<span class="special">{</span>
    <span class="identifier">CPPAN_DECLARE_AND_ANNOTATE</span><span class="special">(</span>
        <span class="special">((</span><span class="keyword">int</span><span class="special">,</span> <span class="identifier">b1</span><span class="special">,</span>
            <span class="special">((</span><span class="identifier">b1_ann</span><span class="special">,</span> <span class="number">42</span><span class="special">))</span>
        <span class="special">))</span>
    <span class="special">)</span>
<span class="special">};</span>

<span class="keyword">struct</span> <span class="identifier">B2</span>
<span class="special">{</span>
    <span class="identifier">CPPAN_DECLARE_AND_ANNOTATE</span><span class="special">(</span>
        <span class="special">((</span><span class="keyword">int</span><span class="special">,</span> <span class="identifier">b2</span><span class="special">,</span>
            <span class="special">((</span><span class="identifier">b2_ann</span><span class="special">,</span> <span class="string">"Hello"</span><span class="special">))</span>
        <span class="special">))</span>
    <span class="special">)</span>
<span class="special">};</span>

<span class="keyword">struct</span> <span class="identifier">D</span> <span class="special">:</span> <span class="identifier">B1</span><span class="special">,</span> <span class="identifier">B2</span>
<span class="special">{</span>
    <span class="identifier">CPPAN_DECLARE_AND_ANNOTATE_WITH_BASE</span><span class="special">(</span>
        <span class="special">(</span><span class="identifier">B1</span><span class="special">)(</span><span class="identifier">B2</span><span class="special">),</span>
        <span class="special">((</span><span class="keyword">int</span><span class="special">,</span> <span class="identifier">d</span><span class="special">,</span>
            <span class="special">((</span><span class="identifier">d_ann</span><span class="special">,</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">true_type</span><span class="special">()))</span>
        <span class="special">))</span>
    <span class="special">)</span>
<span class="special">};</span>
</pre>
<p>
        Now <code class="computeroutput"><span class="identifier">D</span></code> type is viewed by fusion
        as sequence of b1, b2 and d.
      </p>
<pre class="programlisting"><span class="identifier">D</span> <span class="identifier">d</span><span class="special">;</span>
<span class="identifier">d</span><span class="special">.</span><span class="identifier">b1</span> <span class="special">=</span> <span class="number">10</span><span class="special">;</span>
<span class="identifier">d</span><span class="special">.</span><span class="identifier">b2</span> <span class="special">=</span> <span class="number">20</span><span class="special">;</span>
<span class="identifier">d</span><span class="special">.</span><span class="identifier">b3</span> <span class="special">=</span> <span class="number">30</span><span class="special">;</span>

<span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="identifier">d</span> <span class="special">&lt;&lt;</span> <span class="identifier">endl</span><span class="special">;</span>
</pre>
<p>
        will produce
      </p>
<pre class="programlisting"><span class="special">(</span><span class="number">10</span> <span class="number">20</span> <span class="number">30</span><span class="special">)</span>
</pre>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2013 Kozlov Taras<p>
        Distributed under the Boost Software License, Version 1.0 (see accompanying
        file LICENSE_1_0.txt or a copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="../index.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="../reference.html"><img src="../images/next.png" alt="Next"></a>
</div>
</body>
</html>
